graphql:
  handler: src/modules/graphql/graphql.handler
  environment:
    SLS_DEBUG: true
  iamRoleStatementsName: ${self:custom.stackname}-graphql
  iamRoleStatements:
    - Effect: 'Allow'
      Action:
        - dynamodb:GetItem
        - dynamodb:PutItem
        - dynamodb:DeleteItem
        - dynamodb:UpdateItem
        - dynamodb:Query
        - dynamodb:Scan
        - dynamodb:BatchGetItem
        - dynamodb:BatchWriteItem
      Resource: 'arn:aws:dynamodb:${self:provider.region}:*:table/${self:custom.stackname}-main'
  timeout: 5
  memorySize: 512
  reservedConcurrency: 5
  events:
    - http:
        method: ANY
        path: /graphql
        authorizer:
          type: COGNITO_USER_POOLS
          authorizerId:
            Ref: ApiGatewayAuthorizer
        cors:
          origins:
            - '*'
  package:
    include:
      - src/graphql/**
